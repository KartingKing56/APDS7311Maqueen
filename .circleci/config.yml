# This config was automatically generated from your source code
# Stacks detected: deps:node:.
version: 2.1
orbs:
  node: circleci/node@5
jobs:
  test-node:
    # Install node dependencies and run tests
    executor: node/default
    steps:
      - checkout
      - node/install-packages:
          pkg-manager: npm
      - run:
          name: Run tests
          command: echo \"No test specified in package.json\"
      - run: 
          name: Install SonarQube Scanner 
          command: | 
            curl -Lo sonar-scanner.zip https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-4.6.2.2472-linux.zip 
            unzip sonar-scanner.zip -d /tmp
            mv /tmp/sonar-scanner-4.6.2.2472-linux/ /usr/local/sonar-scanner 
            export PATH=$PATH:/usr/local/sonar-scanner/bin 
      - run: 
          name: Run SonarQube Scan 
          command: | 
            sonar-scanner \ 
            -Dsonar.projectKey=$SONAR_PROJECT_KEY \ 
            -Dsonar.organization=$SONAR_ORGANIZATION \ 
            -Dsonar.host.url=$SONAR_HOST_URL \ 
            -Dsonar.login=$SONAR_TOKEN    
  deploy:
    # This is an example deploy job, not actually used by the workflow
    docker:
      - image: cimg/base:stable
    steps:
      # Replace this with steps to deploy to users
      - run:
          name: deploy
          command: '#e.g. ./deploy.sh'
workflows:
  build-and-test:
    jobs:
      - test-node
    # - deploy:
    #     requires:
    #       - test-node
